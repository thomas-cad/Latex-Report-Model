%Figures
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{float}

%Taille marges
\usepackage{geometry}
\geometry{hmargin=2.5cm,vmargin=2.5cm}

%Langue FR
\usepackage[utf8]{inputenc}
\usepackage[french]{babel}
\usepackage{lipsum}

%Ligne titre
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

%Abastract
\newcommand{\motscles}[1]{\vspace{.2cm}\noindent{\large{\bf Mots-Clés:}} #1\\}
\newcommand{\keywords}[1]{\vspace{.2cm}\noindent{\large{\bf Keywords:}} #1\\}

%Abbreviations
\usepackage{acro}

%Réglage header & footer
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead[L]{\rightmark}
\fancyhead[R]{}
\fancyfoot[L]{}
\fancyfoot[R]{\thepage}
\fancyfoot[C]{}
\renewcommand{\footrulewidth}{1pt}
\renewcommand{\headrulewidth}{1pt}

%Watermark
\usepackage{draftwatermark}

%Bib
\usepackage{cite}
\usepackage{url}

%Hyper link
\usepackage{hyperref}

%Annexes
\usepackage{titlesec}
\usepackage{appendix}
\renewcommand{\appendixpagename}{Annexes}
\renewcommand{\appendixtocname}{Annexes}
% Redéfinir les titres des chapitres pour les annexes
\newcommand{\appendixchapterformat}{%
  \titleformat{\chapter}[block]{\normalfont\huge\bfseries}{\thechapter.}{1em}{}%
}

%Insérer du code
\usepackage{listings}
\usepackage{xcolor}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\lstset{style=mystyle}

% Définir un style pour JSON
\lstdefinelanguage{json}{
    basicstyle=\ttfamily\footnotesize,
    showstringspaces=false,
    breaklines=true,
    frame=lines,
    backgroundcolor=\color{backcolour},
    literate=
     *{0}{{{\color{blue}0}}}{1}
      {1}{{{\color{blue}1}}}{1}
      {2}{{{\color{blue}2}}}{1}
      {3}{{{\color{blue}3}}}{1}
      {4}{{{\color{blue}4}}}{1}
      {5}{{{\color{blue}5}}}{1}
      {6}{{{\color{blue}6}}}{1}
      {7}{{{\color{blue}7}}}{1}
      {8}{{{\color{blue}8}}}{1}
      {9}{{{\color{blue}9}}}{1}
      {:}{{{\color{red}{:}}}}{1}
      {,}{{{\color{red}{,}}}}{1}
      {\{}{{{\color{magenta}{\{}}}}{1}
      {\}}{{{\color{magenta}{\}}}}}{1}
      {[}{{{\color{magenta}{[}}}}{1}
      {]}{{{\color{magenta}{]}}}}{1},
}

% Define VBA language for listings
\lstdefinelanguage{VBA}{
    morekeywords={%
        % List of VBA keywords
        % Source: https://bettersolutions.com/vba/keywords/index.htm
        Access, And, As, Attribute, Boolean, ByRef, ByVal, Call, Case, Class, CLng, Close, Const, Date, Debug, Declare, Dim, Do, Double, Each, Else, ElseIf, End, EndFunction, EndIf, EndProperty, EndSelect, EndSub, EndType, EndWith, Enum, Eqv, Error, Event, Exit, Explicit, False, For, Friend, Function, Get, Global, GoTo, If, Imp, Implements, In, Input, Is, Let, Lib, Like, Long, Loop, Mod, New, Next, Not, Nothing, Null, Object, On, Option, Optional, Or, Output, ParamArray, Preserve, Private, Property, Public, RaiseEvent, ReDim, Rem, RemoveHandler, Resume, Return, RSet, Select, Set, Single, Static, Step, Stop, Sub, Text, Then, To, True, Type, Unicode, Until, Variant, Wend, While, With, WithEvents, Write, Xor%
    },
    sensitive=false,  % VBA is not case-sensitive
    morecomment=[l]{'},  % Single-line comments start with '
    morecomment=[s]{Rem}{\n},  % Multi-line comments start with Rem and end with newline
    morestring=[b]",  % Strings are enclosed in double quotes
    morestring=[b]'  % Strings can also be enclosed in single quotes
}

%Algorithme
\usepackage[ruled,lined]{algorithm2e}